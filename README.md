# PlayerPages

**PlayerPages** is a web application that generates and hosts minimalist, largely self-contained pages, which contain a mnenu, a media player with several options, and some optional branding.

It assumes that media is in H.264 / AAC, either in an MP4 container or as HLS, and is hosted on an external server (presumably a CDN).
It uses hls.js to provide HLS support on browsers with MSE.

PlayerPages is designed to make a media player as accessible as possible, for various users, devices, and use cases. The current goals for PlayerPages are:

1. Support for dedicated accessibility technologies, in particular:
    * screen readers (buttons should have labels, page should have regions, keep irrelevant noise to a minimum)
    * system light/dark colors
    * Windows high contrast mode
2. Support for older browsers and devices, in particular:
    * Modern browsers in general
    * iOS 6 (as a stand-in for old mobile devices in general)
    * TenFourFox with MP4 Enabler
    * Wii U Internet Browser (and its outdated certificate store)
    * Internet Explorer 5+ with VLC ActiveX plugin (can be tested with IE Mode in Edge)
3. Support for high-attendance scenarios
    * The pages generated by PlayerPages (HTML, CSS, and JavaScript) can be served over a public CDN without any public traffic going back to the web server
    * PlayerPages should allow an external app to add/edit/delete a page, and invalidate the CDN when this happens
    * PlayerPages should allow an external app to privately fetch a page that may be hidden from the public and proxy it to its own user(s)

Techniques used to accompish some of the more uncommon goals of this project include:

* Disabling autoplay - old devices, like my PowerMac G4, need the lowest
  quality video to avoid freezing up the system; they can select it using a
  button in the player before they hit Play
* Checking the content type of media with a HEAD request on page load; both to
  determine whether the media is HLS (and should be played with hls.js when
  supported), and to determine whether the browser can access it at all
    * If the media is not accessible via AJAX, using the fallback behavior
      where the media menu entry is a link to open the URL in a new tab (on
      mobile devices, this should work even for HLS)
    * Guessing and attempting the HTTP URL if HTTPS does not work (may be
      helpful on devices with old certificate stores, especially if the player
      page is served over plain HTTP from a CDN; required for Wii U support)
* Adding "hidden" buttons to the player controls for quick volume (up/down)
  and seek (+/- 10/30 sec) actions - these buttons are available to screen
  readers,, where operating a range control is more awkward, and can be
  revealed with the Tab key
* Only using the flexbox-based layout on browsers that fully support it, and
  falling back to minimalist CSS that renders the app as a single page on
  older browsers

TODO:

* Google Cast support
* AirPlay support
* Make sure screen reader region navigaton (NVDA: D / Shift+D) works well
* Test system colors, high contast
* Test right-to-left text, if applicable
* Add backend to store pages, and API to add/edit/delete them
* Add a way for API user to view a page that isn't public (make sure base href works)
* Add an interface to invalidate CDN (no-op for now)
